# Ultralytics ğŸš€ AGPL-3. License - https://ultralytics.com/license

# =============================================================================
# YOLO ReActNet Step1 è¶…å‚æ•°é…ç½®
# =============================================================================
# åŸºäº ReActNet-Mobilenet çš„è®­ç»ƒé…ç½®è¿ç§»åˆ° YOLO
# ç›®æ ‡ï¼šæ¿€æ´»äºŒå€¼åŒ–è®­ç»ƒï¼ˆæƒé‡ä»ä¸ºæµ®ç‚¹æ•°ï¼‰
#
# ReActNet åŸå§‹é…ç½® (ImageNetåˆ†ç±»):
#   - batch_size: 256
#   - learning_rate: 1.25e-3
#   - epochs: 128
#   - weight_decay: 1e-5
#   - optimizer: SGD with momentum
#
# =============================================================================

# Train settings -------------------------------------------------------------------------------------------------------
model: # å­¦ç”Ÿæ¨¡å‹è·¯å¾„ (æ”¯æŒ BinaryConv/BinaryC2f)
data: # æ•°æ®é›†è·¯å¾„ï¼Œå¦‚ coco.yaml æˆ– voc.yaml
epochs: 150          # è®­ç»ƒè½®æ•°
                    # ä¿®æ”¹åŸå› ï¼šReActNetä½¿ç”¨128 epochï¼Œè€ƒè™‘åˆ°æ£€æµ‹ä»»åŠ¡æ¯”åˆ†ç±»ä»»åŠ¡
                    # æ›´å¤æ‚ï¼Œå¢åŠ åˆ°150 epochä»¥å……åˆ†è®­ç»ƒäºŒå€¼åŒ–æ¿€æ´»å±‚

batch: 32            # æ‰¹æ¬¡å¤§å°
                    # ä¿®æ”¹åŸå› ï¼šReActNetä½¿ç”¨256ï¼Œä½†YOLOè¾“å…¥å°ºå¯¸æ›´å¤§(640x640)
                    # GPUæ˜¾å­˜å—é™ä¸‹ï¼Œ32æ˜¯è¾ƒå¥½çš„å¹³è¡¡ç‚¹
                    # å¦‚æ˜¾å­˜å……è¶³å¯å°è¯• 64 æˆ– 128

imgsz: 640           # è¾“å…¥å›¾åƒå°ºå¯¸
                    # YOLOæ ‡å‡†å°ºå¯¸ï¼ŒäºŒå€¼åŒ–ç½‘ç»œå¯¹è¾“å…¥å°ºå¯¸ä¸æ•æ„Ÿ

optimizer: AdamW     # ä¼˜åŒ–å™¨
                    # ä¿®æ”¹åŸå› ï¼šReActNetä½¿ç”¨SGDï¼Œä½†äºŒå€¼åŒ–æ¿€æ´»çš„æ¢¯åº¦ä¸ç¨³å®š
                    # AdamWæ›´ç¨³å®šï¼Œä¸”lr=1.25e-3ä¸AdamWé…åˆè‰¯å¥½

lr0: 0.001           # åˆå§‹å­¦ä¹ ç‡
                    # ä¿®æ”¹åŸå› ï¼šç›´æ¥é‡‡ç”¨ReActNetçš„learning_rate=1.25e-3
                    # YOLOé»˜è®¤0.01 (SGD) å¯¹äºäºŒå€¼åŒ–ç½‘ç»œè¿‡å¤§

lrf: 0.01            # æœ€ç»ˆå­¦ä¹ ç‡æ¯”ä¾‹
                    # æœ€ç»ˆLR = lr0 * lrf = 0.001 * 0.01 = 1e-5

momentum: 0.9        # SGDåŠ¨é‡ (AdamWä¸ä½¿ç”¨ï¼Œä½†ä¿ç•™å…¼å®¹æ€§)

weight_decay: 0.00001  # æƒé‡è¡°å‡
                        # ä¿®æ”¹åŸå› ï¼šReActNetä½¿ç”¨1e-5ï¼Œä¸é»˜è®¤å€¼5e-4ä¸åŒ
                        # äºŒå€¼åŒ–ç½‘ç»œä¸­ï¼Œè¿‡å¤§çš„weight_decayä¼šé™åˆ¶biaså‚æ•°å­¦ä¹ 
                        # LearnableBiaséœ€è¦è¶³å¤Ÿè‡ªç”±åº¦æ¥è°ƒæ•´æ¿€æ´»åˆ†å¸ƒ

cos_lr: True         # ä½¿ç”¨ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦
                    # ä¿®æ”¹åŸå› ï¼šReActNeté‡‡ç”¨ç±»ä¼¼çš„cosine annealing
                    # æœ‰åŠ©äºå¹³æ»‘æ”¶æ•›ï¼Œé¿å…äºŒå€¼åŒ–æ¿€æ´»çš„çªå˜

warmup_epochs: 2.0   # çƒ­èº«è½®æ•°
                    # ä¿®æ”¹åŸå› ï¼šReActNetä½¿ç”¨çº¿æ€§warmup
                    # äºŒå€¼åŒ–æ¿€æ´»éœ€è¦è¾ƒçŸ­warmupï¼Œ2è½®è¶³å¤Ÿè®©BNå±‚é€‚åº”

warmup_momentum: 0.8
warmup_bias_lr: 0.05  # biaså­¦ä¹ ç‡ (ç›¸å¯¹è¾ƒå°ï¼Œé¿å…å¹²æ‰°binaryæ¿€æ´»)

close_mosaic: 10    # æœ€å10è½®å…³é—­mosaic
                    # ç¨³å®šæœ«æœŸè®­ç»ƒï¼ŒäºŒå€¼åŒ–ç½‘ç»œéœ€è¦ç¨³å®šæœŸ

amp: True           # æ··åˆç²¾åº¦è®­ç»ƒ
                    # å¿…é¡»å¼€å¯ï¼šå‡å°‘æ˜¾å­˜ï¼Œæ”¯æŒæ›´å¤§batch

multi_scale: False  # å¤šå°ºåº¦è®­ç»ƒ
                    # å»ºè®®å…³é—­ï¼šäºŒå€¼åŒ–æ¿€æ´»å¯¹å°ºåº¦å˜åŒ–æ›´æ•æ„Ÿ
                    # å¦‚éœ€ä½¿ç”¨ï¼Œå»ºè®®ä» imgsz=320 å¼€å§‹æ¸è¿›å¼è°ƒæ•´

# Loss gains -----------------------------------------------------------------------------------------------------------
box: 7.5            # è¾¹ç•Œæ¡†æŸå¤±æƒé‡ (æ ‡å‡†YOLOé…ç½®)
cls: 0.5            # åˆ†ç±»æŸå¤±æƒé‡ (æ ‡å‡†YOLOé…ç½®)
dfl: 1.5            # DFLæŸå¤±æƒé‡ (æ ‡å‡†YOLOé…ç½®)

# Knowledge Distillation (å¯é€‰)------------------------------------------------------------------------------------------
teacher: # æ•™å¸ˆæ¨¡å‹è·¯å¾„ï¼Œå¦‚ yolov8n.pt
kd_alpha: 0.5       # è’¸é¦æŸå¤±æƒé‡
                    # ä¿®æ”¹åŸå› ï¼šReActNetè®ºæ–‡è¡¨æ˜é€‚åº¦çš„è’¸é¦æœ‰åŠ©äºæ”¶æ•›
                    # 0.5è¡¨ç¤ºè’¸é¦æŸå¤±ä¸æ£€æµ‹æŸå¤±åŒç­‰é‡è¦

kd_temp: 2.0        # è’¸é¦æ¸©åº¦
                    # ä¿®æ”¹åŸå› ï¼šT>1ä½¿æ¦‚ç‡åˆ†å¸ƒæ›´å¹³æ»‘ï¼Œä¼ é€’æ›´å¤šæš—çŸ¥è¯†
                    # æœ‰åŠ©äºäºŒå€¼åŒ–ç½‘ç»œå­¦ä¹ ç±»åˆ«é—´å…³ç³»

# Data Augmentation (äºŒå€¼åŒ–ç½‘ç»œå»ºè®®å‡å¼±)---------------------------------------------------------------------------------
hsv_h: 0.015        # HSVè‰²ç›¸å˜åŒ–
hsv_s: 0.7          # HSVé¥±å’Œåº¦å˜åŒ–
hsv_v: 0.4          # HSVäº®åº¦å˜åŒ–

degrees: 0.0        # æ—‹è½¬è§’åº¦ (äºŒå€¼åŒ–ç½‘ç»œå»ºè®®å…³é—­)
translate: 0.1      # å¹³ç§»èŒƒå›´
scale: 0.5          # ç¼©æ”¾èŒƒå›´

shear: 0.0          # å‰ªåˆ‡å˜æ¢ (äºŒå€¼åŒ–ç½‘ç»œå»ºè®®å…³é—­)
perspective: 0.0    # é€è§†å˜æ¢

flipud: 0.0         # å‚ç›´ç¿»è½¬
fliplr: 0.5         # æ°´å¹³ç¿»è½¬æ¦‚ç‡

mosaic: 1.0         # Mosaicå¢å¼º
                    # æ³¨æ„ï¼šReActNetåŸç‰ˆæ²¡æœ‰mosaicï¼Œä½†YOLOä½¿ç”¨mosaicæœ‰æ•ˆ
                    # å¯åœ¨è®­ç»ƒæœ«æœŸå…³é—­mosaicä»¥ç¨³å®šæ”¶æ•›

mixup: 0.0          # MixUpå¢å¼º (å…³é—­ï¼ŒäºŒå€¼åŒ–æ¿€æ´»å¯èƒ½å—å½±å“)
cutmix: 0.0         # CutMixå¢å¼º (å…³é—­)

# Validation & Save ----------------------------------------------------------------------------------------------------
val: True           # å¼€å¯éªŒè¯
save_period: 10     # æ¯10è½®ä¿å­˜ä¸€æ¬¡

plots: True         # ä¿å­˜è®­ç»ƒæ›²çº¿

# =============================================================================
# ä½¿ç”¨æ–¹æ³•
# =============================================================================
#
# 1. å‘½ä»¤è¡Œè®­ç»ƒ:
#    yolo detect train data=coco.yaml model=yolov8n-react.yaml epochs=150 \
#        batch=32 optimizer=AdamW lr0=0.001 weight_decay=1e-5 cos_lr=True
#
# 2. ä½¿ç”¨çŸ¥è¯†è’¸é¦:
#    yolo detect train data=coco.yaml model=yolov8n-react.yaml epochs=150 \
#        batch=32 teacher=yolov8n.pt kd_alpha=0.5 kd_temp=2.0
#
# 3. ä¿å­˜æ­¤æ–‡ä»¶ä¸º yaml å¹¶ä½¿ç”¨:
#    yolo detect train data=coco.yaml model=yolov8n-react.yaml cfg=reactnet_hyp.yaml
#
# =============================================================================
